import unittest
from typing import List


# LeetCode link: https://leetcode.com/problems/3sum-closest/
# This solution has time complexity O(n^2). Before start the loop, we need to sort our array.
# And in the loop, we retrieve the first integer to sum, and inside first loop,
# we start another loop using two pointer, if sum of three integer is equal to target, return target
# we calculate closest sum to target, and change left pointer if target is greater than sum,
# or change right pointer if target is less than or equal sum.
def three_sum_closest(nums: List[int], target: int) -> int:
    N = len(nums) - 1
    closest = nums[0] + nums[1] + nums[N]

    nums.sort()  # O(n log n)

    for i, val in enumerate(nums):  # O(n)
        if i > 0 and val == nums[i - 1]:
            continue

        l, r = i + 1, N

        while l < r:  # O(n)
            aux = val + nums[l] + nums[r]

            if aux == target:
                return target

            diff = abs(target - aux)
            if diff < abs(target - closest):
                closest = aux

            if target > aux:
                l += 1
            else:
                r -= 1

    return closest


class ThreeSumClosest(unittest.TestCase):
    def test_01(self):
        self.assertEqual(2, three_sum_closest(nums=[-1, 2, 1, -4], target=1))

    def test_02(self):
        self.assertEqual(0, three_sum_closest(nums=[0, 0, 0], target=1))

    def test_03(self):
        self.assertEqual(-2628, three_sum_closest(
            nums=[39, 603, 521, -106, -602, -497, -212, -541, 985, -620, 535, -952, 779, 407, 541, -822, 746, 517, 495,
                  410, -990, 610, -775, -542, -490, 328, 218, -606, -460, 789, 305, 954, -454, 447, 269, 479, -19, 281,
                  -954, -375, -637, 431, -486, 885, -380, 270, 424, 329, -704, -32, 280, 617, 376, 230, 806, -950, 698,
                  48, -73, -377, -301, 464, 530, -457, -506, -415, -688, 606, 929, 934, -823, 619, 798, 98, -589, -776,
                  -729, 141, -143, 59, -305, 466, 319, 887, 684, -140, 237, 1, 95, -779, 150, 470, 770, -168, -114,
                  -466, 809, 905, 910, 566, -263, -874, 469, -921, -718, -604, -316, -462, 539, -590, 109, -354, 516,
                  -583, 635, -144, -652, 665, -615, 444, -555, 394, 807, -482, -870, 810, 36, -728, -987, 909, 819,
                  -883, -920, -344, 519, -322, 206, -991, -223, -151, -365, -10, 704, 843, -568, -443, -854, -249, 318,
                  802, -110, -671, 696, -855, -864, -173, -934, 886, 277, -588, -530, 119, -3, -467, 948, -579, 804,
                  710, -753, 852, -924, -608, 308, 235, 202, 527, 931, -361, 342, -750, 185, -977, 180, 859, -479, 23,
                  -724, -691, 439, 872, 378, -596, 30, 107, -67, 650, 999, -342, 9, -52, 289, 737, 441, -891, 532, 982,
                  200, -285, -755, 756, 784, 888, -498, 379, 858, -546, -487, -104, 258, -985, -973, -202, 240, 223,
                  177, 467, 814, -132, 216, -887, -572, 593, 960, -571, 790, -428, 60, 301, -406, 46, -896, 958, 293,
                  -170, -979, -254, -260, -826, 904, 425, 412, -309, -939, -763, -275, -523, 655, -621, -180, -834,
                  -141, -156, -391, 758, -853, -770, 829, -976, -337, 131, -357, 747, -231, 749, 700, -152, 105, 128,
                  577, 831, 97, -392, 528, -662, 913, 642, 578, 554, 367, 579, -909, -594, -83, -923, -631, -272, 190,
                  52, 339, 914, 955, 537, -277, -96, 647, 513, 217, 106, -714, 66, 101, -644, 112, 869, 228, 975, 866,
                  -609, 648, 166, -964, 572, 759, -895, -528, -654, -211, 351, -205, -684, -456, 420, -885, -401, -241,
                  -124, -774, -226, -169, -112, 926, -182, 259, -439, -993, -478, 147, -936, -139, 75, -794, 104, 335,
                  732, -968, 611, -363, 978, -188, -58, -565, 462, 399, 503, 16, 830, 416, 96, -222, -738, -413, 490,
                  -491, -694, -288, 4, -463, 370, -708, 675, 310, -625, -351, 839, -78, 348, -12, -675, -181, -762, 717,
                  -784, -455, 498, 612, -157, 499, 654, -532, 811, 33, 739, -271, -673, 947, 224, 167, -355, 776, -518,
                  113, 778, 699, -614, 594, -102, -698, 785, -317, -995, -760, 489, 174, 569, -306, 703, 734, -840, 966,
                  968, 344, -227, -886, 196, 587, 629, -663, 688, -635, -975, -390, -982, -121, -2, 315, -850, -162,
                  -739, -717, -522, 786, -283, 733, -683, 640, -676, 550, 476, -87, 31, -217, -55, -370, -62, -251,
                  -163, 660, 590, 669, -695, 236, -955, 867, -30, 143, -465, 430, -553, 199, -917, 450, -244, 346, -851,
                  949, -725, -951, -437, -95, 238, -612, 740, 753, 130, -937, -758, 267, -418, 205, -672, 25, -452, 117,
                  -247, -664, 14, -196, -123, 334, -286, -343, 728, 523, -945, 524, 726, -560, 546, -330, -199, -492,
                  -194, -697, -94, -257, -293, 266, -171, 477, 273, 377, -253, -297, -703, 157, 34, -234, -562, -410,
                  99, -320, -432, 455, 924, -252, -761, -732, -858, -967, -207, -314, -403, 808, 787, 643, 116, -325,
                  -230, -880, 291, -328, 5, -218, 586, -806, -160, -882, 170, -645, -670, 945, 274, 391, -905, 435,
                  -408, 678, 0, -503, 689, -752, -148, -411, 428, -715, -647, -426, -916, 8, -577, 600, -746, 921, 564,
                  265, -969, -839, -984, 365, -389, -878, -709, 80, -4, -333, 627, 853, -335, 965, 774, -364, -807, -39,
                  -550, -412, -61, -622, 951, -638, -766, -485, 159, 821, -767, 415, 44, 110, -544, 772, -319, 840,
                  -385, -988, 207, 189, 873, -97, -470, -65, 984, 368, -70, 884, 671, -25, 451, 663, 486, -959, -47,
                  957, -177, -765, 45, -819, -158, 705, 32, -371, 972, 837, 349, 582, -313, -785, 994, -618, -11, 672,
                  -601, -119, -38, -726, 41, -450, -442, -813, 354, 57, 111, -640, 662, 723, -795, 405, 712, -79, -978,
                  -997, -8, -686, -912, -533, -869, 735, -472, 162, 653, -705, -240, 962, -242, -841, -769, -346, 868,
                  -239, 668, -175, -757, 272, -105, 497, 440, -236, 213, 801, 625, -759, -529, 697, 92, -368, -744, 50,
                  656, -863, 916, -524, 568, 155, -919, -383, -832, 639, 543, -5, -259, -520, -451, -484, -45, -179,
                  -908, 307, 7, 175, 907, 282, 992, 485, 538, -107, -476, 320, -557, 986, -471, -648, 782, -324, -786,
                  -500, 638, -29, 271, -706, 879, 402, 94, -396, -213, -962, -783, -949, 822, 980, -781, -626, 37, 500,
                  481, 803, -488, -561, 641, -844, -336, 693, -537, -189, 883, 494, 794, -981, 163, 584, 121, -843,
                  -427, 730, 649, -424, 483, 570, 842, 933, 977, 171, -366, 686, 221, -80, 332, 856, 906, -893, 191,
                  414, -633, -667, 139, -150, -734, 133, -970, 103, 645, -856, 132, 298, -519, 542, -331, -274, 661,
                  255, 937, -563, 390, -659, 956, 795, 760, 805, -483, 325, 777, 361, 767, 395, -34, 707, 846, -578,
                  -89, 953, 278, 826, 314, -906, -642, -825, -866, 446, -668, 637, -268, -679, 687, 681, 345, -407, -31,
                  360, -387, -701, -569, 86, 252, -831, 942, 183, 362, -534, 350, -127, 61, 720, 417, -768, 708, -445,
                  938, 2, -512, -899, 970, 471, -898, 250, 437, -159, 296, -149, 176, 353, 591, 445, -711, 651, 602,
                  244, 458, -399, 694, -559, -433, 454, 748, -281, 43, 995, -340, 971, 773, 26, -598, 179, -481, 556,
                  -315, -300, -499, -197, 588, 182, -421, 178, 172, 908, -278, 522, -748, -334, 797, -215, 77, 436,
                  -597, -429, -918, 990, 736, 142, -323, 605, 899, -279, 754, 275, 792, -651, 981, 750, 771, -857,
                  761], target=-2628))
